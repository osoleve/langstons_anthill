{"version":3,"file":"index-rsnDIQNx.js","sources":["../../src/sse/client.ts","../../src/renderer/canvas.ts","../../src/renderer/tiles.ts","../../src/renderer/entities.ts","../../src/renderer/particles.ts","../../src/renderer/spirits.ts","../../src/ui/panels.ts","../../src/ui/tooltip.ts","../../src/main.ts"],"sourcesContent":["import type { GameState } from '../types/state.ts'\r\n\r\nexport type StateHandler = (state: GameState) => void\r\n\r\nexport class SSEClient {\r\n  private eventSource: EventSource | null = null\r\n  private handlers: Set<StateHandler> = new Set()\r\n  private lastState: GameState | null = null\r\n\r\n  constructor(private url: string = '/events') {}\r\n\r\n  connect(): void {\r\n    this.eventSource = new EventSource(this.url)\r\n\r\n    this.eventSource.onmessage = (event) => {\r\n      try {\r\n        const state = JSON.parse(event.data) as GameState\r\n        this.lastState = state\r\n        this.handlers.forEach(handler => handler(state))\r\n      } catch (e) {\r\n        console.error('Failed to parse state:', e)\r\n      }\r\n    }\r\n\r\n    this.eventSource.onerror = () => {\r\n      console.error('SSE connection error, reconnecting...')\r\n      this.reconnect()\r\n    }\r\n  }\r\n\r\n  private reconnect(): void {\r\n    this.disconnect()\r\n    setTimeout(() => this.connect(), 2000)\r\n  }\r\n\r\n  disconnect(): void {\r\n    if (this.eventSource) {\r\n      this.eventSource.close()\r\n      this.eventSource = null\r\n    }\r\n  }\r\n\r\n  onState(handler: StateHandler): () => void {\r\n    this.handlers.add(handler)\r\n    // If we already have state, call handler immediately\r\n    if (this.lastState) {\r\n      handler(this.lastState)\r\n    }\r\n    return () => this.handlers.delete(handler)\r\n  }\r\n\r\n  getLastState(): GameState | null {\r\n    return this.lastState\r\n  }\r\n}\r\n\r\n// Fetch initial state\r\nexport async function fetchInitialState(): Promise<GameState | null> {\r\n  try {\r\n    const response = await fetch('/state')\r\n    return await response.json() as GameState\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n","export interface CanvasContext {\r\n  canvas: HTMLCanvasElement\r\n  ctx: CanvasRenderingContext2D\r\n  width: number\r\n  height: number\r\n}\r\n\r\nexport function setupCanvas(container: HTMLElement): CanvasContext {\r\n  const canvas = document.createElement('canvas')\r\n  canvas.style.position = 'absolute'\r\n  canvas.style.top = '0'\r\n  canvas.style.left = '0'\r\n  canvas.style.pointerEvents = 'none'\r\n  container.appendChild(canvas)\r\n\r\n  const ctx = canvas.getContext('2d')!\r\n\r\n  function resize() {\r\n    canvas.width = container.clientWidth\r\n    canvas.height = container.clientHeight\r\n  }\r\n\r\n  resize()\r\n  window.addEventListener('resize', resize)\r\n\r\n  return {\r\n    canvas,\r\n    ctx,\r\n    get width() { return canvas.width },\r\n    get height() { return canvas.height }\r\n  }\r\n}\r\n\r\nexport function clearCanvas(context: CanvasContext): void {\r\n  context.ctx.clearRect(0, 0, context.width, context.height)\r\n}\r\n","import type { GameState, Tile } from '../types/state.ts'\r\n\r\nexport interface TilePosition {\r\n  x: number\r\n  y: number\r\n  centerX: number\r\n  centerY: number\r\n}\r\n\r\nconst TILE_SIZE = 100\r\nconst TILE_GAP = 20\r\nconst OFFSET_X = 250\r\nconst OFFSET_Y = 150\r\n\r\nexport function getTilePosition(tile: Tile): TilePosition {\r\n  const x = tile.x * (TILE_SIZE + TILE_GAP) + OFFSET_X\r\n  const y = tile.y * (TILE_SIZE + TILE_GAP) + OFFSET_Y\r\n  return {\r\n    x,\r\n    y,\r\n    centerX: x + TILE_SIZE / 2,\r\n    centerY: y + TILE_SIZE / 2\r\n  }\r\n}\r\n\r\nexport function getTileCenter(tileId: string, tiles: Record<string, Tile>): { x: number; y: number } | null {\r\n  const tile = tiles[tileId]\r\n  if (!tile) return null\r\n  const pos = getTilePosition(tile)\r\n  return { x: pos.centerX, y: pos.centerY }\r\n}\r\n\r\nexport function renderTiles(container: HTMLElement, state: GameState): void {\r\n  // Clear existing tiles\r\n  const existing = container.querySelector('.tiles-container')\r\n  if (existing) existing.remove()\r\n\r\n  const tilesContainer = document.createElement('div')\r\n  tilesContainer.className = 'tiles-container'\r\n  container.appendChild(tilesContainer)\r\n\r\n  const tiles = state.map?.tiles ?? {}\r\n  const systems = state.systems ?? {}\r\n  const entities = state.entities ?? []\r\n\r\n  for (const [id, tile] of Object.entries(tiles)) {\r\n    const div = document.createElement('div')\r\n    div.className = 'tile'\r\n\r\n    // System status\r\n    const system = systems[id]\r\n    if (system) {\r\n      div.classList.add('has-system')\r\n      if (system.generates && Object.keys(system.generates).length > 0) {\r\n        div.classList.add('generating')\r\n      }\r\n    }\r\n\r\n    // Blight\r\n    if (tile.blighted) {\r\n      div.classList.add('blighted')\r\n    }\r\n\r\n    // Antenna\r\n    if (tile.type === 'antenna') {\r\n      div.classList.add('antenna')\r\n      if ((state.resources?.influence ?? 0) > 0.5) {\r\n        div.classList.add('broadcasting')\r\n      }\r\n    }\r\n\r\n    const pos = getTilePosition(tile)\r\n    div.style.left = `${pos.x}px`\r\n    div.style.top = `${pos.y}px`\r\n\r\n    // Count entities\r\n    const antsHere = entities.filter(e => e.tile === id && e.type !== 'visitor').length\r\n    const visitorsHere = entities.filter(e => e.tile === id && e.type === 'visitor').length\r\n\r\n    let entityInfo = ''\r\n    if (antsHere > 0) {\r\n      entityInfo += `<div class=\"ant-count\">${antsHere} ant${antsHere > 1 ? 's' : ''}</div>`\r\n    }\r\n    if (visitorsHere > 0) {\r\n      entityInfo += `<div class=\"ant-count visitor-count\">${visitorsHere} visitor${visitorsHere > 1 ? 's' : ''}</div>`\r\n    }\r\n\r\n    div.innerHTML = `\r\n      <div class=\"tile-name\">${tile.name}</div>\r\n      <div class=\"tile-info\">${tile.type}</div>\r\n      ${entityInfo}\r\n    `\r\n\r\n    tilesContainer.appendChild(div)\r\n  }\r\n}\r\n\r\nexport function drawConnections(\r\n  ctx: CanvasRenderingContext2D,\r\n  state: GameState\r\n): void {\r\n  const tiles = state.map?.tiles\r\n  const connections = state.map?.connections\r\n  if (!tiles || !connections) return\r\n\r\n  ctx.strokeStyle = '#333'\r\n  ctx.lineWidth = 1\r\n  ctx.setLineDash([4, 4])\r\n\r\n  for (const [from, to] of connections) {\r\n    const fromCenter = getTileCenter(from, tiles)\r\n    const toCenter = getTileCenter(to, tiles)\r\n    if (fromCenter && toCenter) {\r\n      ctx.beginPath()\r\n      ctx.moveTo(fromCenter.x, fromCenter.y)\r\n      ctx.lineTo(toCenter.x, toCenter.y)\r\n      ctx.stroke()\r\n    }\r\n  }\r\n\r\n  ctx.setLineDash([])\r\n}\r\n","import type { GameState, Entity, Tile } from '../types/state.ts'\r\nimport { getTileCenter } from './tiles.ts'\r\n\r\ninterface EntityDot {\r\n  x: number\r\n  y: number\r\n  targetX: number\r\n  targetY: number\r\n  type: 'ant' | 'visitor'\r\n  subtype?: string\r\n  adorned?: boolean\r\n  entity: Entity\r\n}\r\n\r\nconst entityDots: Map<string, EntityDot> = new Map()\r\n\r\n// Expose positions for tooltip system\r\nexport function getEntityDots(): Map<string, EntityDot> {\r\n  return entityDots\r\n}\r\n\r\nexport function updateEntityDots(state: GameState): void {\r\n  const tiles = state.map?.tiles\r\n  const entities = state.entities\r\n  if (!tiles || !entities) return\r\n\r\n  // Update or create dots for each entity\r\n  for (const entity of entities) {\r\n    const tileCenter = getTileCenter(entity.tile, tiles)\r\n    if (!tileCenter) continue\r\n\r\n    let dot = entityDots.get(entity.id)\r\n    if (!dot) {\r\n      // Create new dot with random offset within tile\r\n      dot = {\r\n        x: tileCenter.x + (Math.random() - 0.5) * 60,\r\n        y: tileCenter.y + (Math.random() - 0.5) * 60,\r\n        targetX: tileCenter.x + (Math.random() - 0.5) * 60,\r\n        targetY: tileCenter.y + (Math.random() - 0.5) * 60,\r\n        type: entity.type,\r\n        subtype: entity.subtype,\r\n        adorned: entity.adorned,\r\n        entity: entity\r\n      }\r\n      entityDots.set(entity.id, dot)\r\n    }\r\n\r\n    // Slowly drift toward target\r\n    dot.x += (dot.targetX - dot.x) * 0.02\r\n    dot.y += (dot.targetY - dot.y) * 0.02\r\n\r\n    // Pick new target occasionally\r\n    if (Math.random() < 0.01) {\r\n      dot.targetX = tileCenter.x + (Math.random() - 0.5) * 60\r\n      dot.targetY = tileCenter.y + (Math.random() - 0.5) * 60\r\n    }\r\n\r\n    // Update entity properties\r\n    dot.type = entity.type\r\n    dot.subtype = entity.subtype\r\n    dot.adorned = entity.adorned\r\n    dot.entity = entity\r\n  }\r\n\r\n  // Remove dots for dead entities\r\n  const livingIds = new Set(entities.map(e => e.id))\r\n  for (const id of entityDots.keys()) {\r\n    if (!livingIds.has(id)) {\r\n      entityDots.delete(id)\r\n    }\r\n  }\r\n}\r\n\r\nexport function drawEntityDots(ctx: CanvasRenderingContext2D): void {\r\n  for (const [_id, dot] of entityDots) {\r\n    ctx.beginPath()\r\n    const size = dot.adorned ? 5 : 4\r\n\r\n    if (dot.type === 'visitor') {\r\n      // Visitors glow blue (or red if hungry)\r\n      const color = dot.subtype === 'hungry' ? '#f88' : '#8af'\r\n      ctx.arc(dot.x, dot.y, size, 0, Math.PI * 2)\r\n      ctx.fillStyle = color\r\n      ctx.shadowColor = color\r\n      ctx.shadowBlur = 8\r\n    } else if (dot.adorned) {\r\n      // Adorned ants have golden glow\r\n      ctx.arc(dot.x, dot.y, size, 0, Math.PI * 2)\r\n      ctx.fillStyle = '#ca8'\r\n      ctx.shadowColor = '#ca8'\r\n      ctx.shadowBlur = 6\r\n    } else {\r\n      // Regular ants\r\n      ctx.arc(dot.x, dot.y, size - 1, 0, Math.PI * 2)\r\n      ctx.fillStyle = '#a85'\r\n      ctx.shadowBlur = 0\r\n    }\r\n\r\n    ctx.fill()\r\n    ctx.shadowBlur = 0\r\n  }\r\n}\r\n","import type { GameState, Tile } from '../types/state.ts'\r\nimport { getTileCenter } from './tiles.ts'\r\n\r\ninterface Particle {\r\n  x: number\r\n  y: number\r\n  targetX: number\r\n  targetY: number\r\n  progress: number\r\n  speed: number\r\n  color: string\r\n  size: number\r\n}\r\n\r\nconst particles: Particle[] = []\r\n\r\nfunction spawnParticle(\r\n  from: { x: number; y: number },\r\n  to: { x: number; y: number },\r\n  color: string\r\n): void {\r\n  particles.push({\r\n    x: from.x,\r\n    y: from.y,\r\n    targetX: to.x,\r\n    targetY: to.y,\r\n    progress: 0,\r\n    speed: 0.01 + Math.random() * 0.01,\r\n    color,\r\n    size: 2 + Math.random() * 2\r\n  })\r\n}\r\n\r\nexport function updateParticles(): void {\r\n  // Update existing particles\r\n  for (let i = particles.length - 1; i >= 0; i--) {\r\n    const p = particles[i]\r\n    p.progress += p.speed\r\n    p.x += (p.targetX - p.x) * p.speed * 2\r\n    p.y += (p.targetY - p.y) * p.speed * 2\r\n\r\n    // Remove completed particles\r\n    if (p.progress >= 1) {\r\n      particles.splice(i, 1)\r\n    }\r\n  }\r\n}\r\n\r\nexport function spawnResourceParticles(state: GameState): void {\r\n  const tiles = state.map?.tiles\r\n  if (!tiles) return\r\n\r\n  // Dig site -> origin (dirt)\r\n  if (Math.random() < 0.1) {\r\n    const from = getTileCenter('dig_site', tiles)\r\n    const to = getTileCenter('origin', tiles)\r\n    if (from && to) spawnParticle(from, to, '#8b7355')\r\n  }\r\n\r\n  // Compost -> origin (nutrients)\r\n  if (Math.random() < 0.05) {\r\n    const from = getTileCenter('compost', tiles)\r\n    const to = getTileCenter('origin', tiles)\r\n    if (from && to) spawnParticle(from, to, '#5a8a5a')\r\n  }\r\n\r\n  // Origin -> fungus farm (nutrients)\r\n  if (Math.random() < 0.05) {\r\n    const from = getTileCenter('origin', tiles)\r\n    const to = getTileCenter('fungus_farm', tiles)\r\n    if (from && to) spawnParticle(from, to, '#5a8a5a')\r\n  }\r\n\r\n  // Fungus farm -> origin (fungus)\r\n  if (Math.random() < 0.03) {\r\n    const from = getTileCenter('fungus_farm', tiles)\r\n    const to = getTileCenter('origin', tiles)\r\n    if (from && to) spawnParticle(from, to, '#7a6a9a')\r\n  }\r\n\r\n  // Crystal cave -> resonance (crystals)\r\n  if (Math.random() < 0.02) {\r\n    const from = getTileCenter('crystal_cave', tiles)\r\n    const to = getTileCenter('resonance_chamber', tiles)\r\n    if (from && to) spawnParticle(from, to, '#aaccff')\r\n  }\r\n\r\n  // Resonance -> origin (nutrients from crystals)\r\n  if (Math.random() < 0.08) {\r\n    const from = getTileCenter('resonance_chamber', tiles)\r\n    const to = getTileCenter('origin', tiles)\r\n    if (from && to) spawnParticle(from, to, '#88aacc')\r\n  }\r\n\r\n  // Origin -> receiver (influence)\r\n  if ((state.resources?.influence ?? 0) > 0 && Math.random() < 0.05) {\r\n    const from = getTileCenter('origin', tiles)\r\n    const to = getTileCenter('receiver', tiles)\r\n    if (from && to) spawnParticle(from, to, '#aa88ff')\r\n  }\r\n\r\n  // Observer generating insight\r\n  const hasObserver = state.entities?.some(e => e.subtype === 'observer')\r\n  if (hasObserver && Math.random() < 0.1) {\r\n    const from = getTileCenter('receiver', tiles)\r\n    if (from) {\r\n      spawnParticle(\r\n        { x: from.x + (Math.random() - 0.5) * 30, y: from.y + (Math.random() - 0.5) * 30 },\r\n        { x: from.x, y: from.y - 40 },\r\n        '#88ffaa'\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nexport function drawParticles(ctx: CanvasRenderingContext2D): void {\r\n  for (const p of particles) {\r\n    ctx.beginPath()\r\n    ctx.arc(p.x, p.y, p.size * (1 - p.progress * 0.5), 0, Math.PI * 2)\r\n    ctx.fillStyle = p.color\r\n    ctx.globalAlpha = 1 - p.progress\r\n    ctx.fill()\r\n  }\r\n  ctx.globalAlpha = 1\r\n}\r\n","import type { GameState } from '../types/state.ts'\r\nimport { getTileCenter } from './tiles.ts'\r\n\r\ninterface Spirit {\r\n  id: string\r\n  x: number\r\n  y: number\r\n  baseY: number\r\n  alpha: number\r\n  phase: number\r\n  isVisitor: boolean\r\n}\r\n\r\nconst spirits: Map<string, Spirit> = new Map()\r\n\r\nexport function updateSpirits(state: GameState): void {\r\n  const tiles = state.map?.tiles\r\n  const corpses = state.graveyard?.corpses ?? []\r\n  if (!tiles) return\r\n\r\n  const corpseIds = new Set(corpses.map(c => c.entity_id))\r\n\r\n  // Add new spirits for fresh corpses\r\n  for (const corpse of corpses) {\r\n    if (!spirits.has(corpse.entity_id)) {\r\n      const center = getTileCenter(corpse.tile, tiles)\r\n      if (center) {\r\n        spirits.set(corpse.entity_id, {\r\n          id: corpse.entity_id,\r\n          x: center.x + (Math.random() - 0.5) * 40,\r\n          y: center.y + (Math.random() - 0.5) * 40,\r\n          baseY: center.y + (Math.random() - 0.5) * 40,\r\n          alpha: 0.6,\r\n          phase: Math.random() * Math.PI * 2,\r\n          isVisitor: corpse.entity_type === 'visitor'\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  // Update existing spirits - float upward slowly, fade\r\n  for (const [id, spirit] of spirits) {\r\n    spirit.phase += 0.02\r\n    spirit.y = spirit.baseY + Math.sin(spirit.phase) * 5 - (spirit.phase * 0.3) // Drift upward\r\n    spirit.alpha -= 0.0005 // Slow fade\r\n\r\n    // Remove spirits that have faded or risen too high\r\n    if (spirit.alpha <= 0 || spirit.y < spirit.baseY - 50) {\r\n      spirits.delete(id)\r\n    }\r\n  }\r\n\r\n  // Remove spirits for processed corpses\r\n  for (const id of spirits.keys()) {\r\n    if (!corpseIds.has(id)) {\r\n      // Corpse was processed - accelerate fade\r\n      const spirit = spirits.get(id)\r\n      if (spirit) {\r\n        spirit.alpha -= 0.02\r\n        if (spirit.alpha <= 0) {\r\n          spirits.delete(id)\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function drawSpirits(ctx: CanvasRenderingContext2D): void {\r\n  for (const [_id, spirit] of spirits) {\r\n    ctx.save()\r\n    ctx.globalAlpha = spirit.alpha\r\n\r\n    // Draw a wispy ghost shape\r\n    const gradient = ctx.createRadialGradient(\r\n      spirit.x, spirit.y, 0,\r\n      spirit.x, spirit.y, 12\r\n    )\r\n\r\n    if (spirit.isVisitor) {\r\n      // Visitor spirits are blue-tinged\r\n      gradient.addColorStop(0, 'rgba(150, 180, 255, 0.8)')\r\n      gradient.addColorStop(0.5, 'rgba(100, 130, 200, 0.4)')\r\n      gradient.addColorStop(1, 'rgba(80, 100, 180, 0)')\r\n    } else {\r\n      // Ant spirits are pale amber\r\n      gradient.addColorStop(0, 'rgba(220, 200, 180, 0.8)')\r\n      gradient.addColorStop(0.5, 'rgba(180, 160, 140, 0.4)')\r\n      gradient.addColorStop(1, 'rgba(150, 130, 110, 0)')\r\n    }\r\n\r\n    ctx.fillStyle = gradient\r\n    ctx.beginPath()\r\n    ctx.arc(spirit.x, spirit.y, 12, 0, Math.PI * 2)\r\n    ctx.fill()\r\n\r\n    // Small highlight\r\n    ctx.beginPath()\r\n    ctx.arc(spirit.x - 2, spirit.y - 2, 3, 0, Math.PI * 2)\r\n    ctx.fillStyle = spirit.isVisitor ? 'rgba(200, 220, 255, 0.5)' : 'rgba(255, 250, 240, 0.5)'\r\n    ctx.fill()\r\n\r\n    ctx.restore()\r\n  }\r\n}\r\n","import type { GameState, Entity } from '../types/state.ts'\r\n\r\nexport function renderTick(state: GameState): void {\r\n  const el = document.getElementById('tick')\r\n  if (el) {\r\n    el.textContent = `tick: ${state.tick}`\r\n  }\r\n}\r\n\r\nexport function renderResources(state: GameState): void {\r\n  const el = document.getElementById('resources')\r\n  if (!el) return\r\n\r\n  const resources = state.resources ?? {}\r\n  if (Object.keys(resources).length === 0) {\r\n    el.innerHTML = '<div class=\"empty\">nothing yet</div>'\r\n    return\r\n  }\r\n\r\n  el.innerHTML = Object.entries(resources)\r\n    .map(([name, value]) => `\r\n      <div class=\"resource\">\r\n        <span class=\"resource-name\">${name}</span>\r\n        <span class=\"resource-value\">${Math.floor(value ?? 0)}</span>\r\n      </div>\r\n    `)\r\n    .join('')\r\n}\r\n\r\nexport function renderEntities(state: GameState): void {\r\n  const el = document.getElementById('entities')\r\n  if (!el) return\r\n\r\n  const entities = state.entities ?? []\r\n  if (entities.length === 0) {\r\n    el.innerHTML = '<div class=\"empty\">no entities</div>'\r\n    return\r\n  }\r\n\r\n  // Group by role\r\n  const byRole: Record<string, number> = {}\r\n  const visitors: Entity[] = []\r\n\r\n  for (const e of entities) {\r\n    if (e.type === 'visitor') {\r\n      visitors.push(e)\r\n    } else {\r\n      const role = e.role ?? e.type ?? 'unknown'\r\n      byRole[role] = (byRole[role] ?? 0) + 1\r\n    }\r\n  }\r\n\r\n  let html = Object.entries(byRole)\r\n    .map(([role, count]) => `\r\n      <div class=\"stat-row\">\r\n        <span class=\"stat-label\">${role}</span>\r\n        <span class=\"stat-value\">${count}</span>\r\n      </div>\r\n    `)\r\n    .join('')\r\n\r\n  // Show visitors separately\r\n  for (const v of visitors) {\r\n    html += `\r\n      <div class=\"stat-row visitor-row\">\r\n        <span class=\"stat-label\">${v.name ?? v.subtype ?? 'visitor'}</span>\r\n        <span class=\"stat-value visitor-subtype\">${v.subtype ?? ''}</span>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  el.innerHTML = html\r\n}\r\n\r\nexport function renderBoredom(state: GameState): void {\r\n  const fill = document.getElementById('boredom-fill')\r\n  if (!fill) return\r\n\r\n  const boredom = state.meta?.boredom ?? 0\r\n  const pct = Math.min(100, (boredom / 60) * 100)\r\n  fill.style.width = `${pct}%`\r\n}\r\n\r\nexport function renderSanity(state: GameState): void {\r\n  const fill = document.getElementById('sanity-fill')\r\n  const value = document.getElementById('sanity-value')\r\n  if (!fill || !value) return\r\n\r\n  const sanity = state.meta?.sanity ?? 100\r\n  fill.style.width = `${sanity}%`\r\n  value.textContent = `${sanity.toFixed(1)}%`\r\n\r\n  // Color based on level\r\n  if (sanity < 30) {\r\n    fill.style.background = '#a44'\r\n  } else if (sanity < 60) {\r\n    fill.style.background = '#a84'\r\n  } else {\r\n    fill.style.background = '#484'\r\n  }\r\n}\r\n\r\nexport function renderContamination(state: GameState): void {\r\n  const fill = document.getElementById('contamination-fill')\r\n  const status = document.getElementById('contamination-status')\r\n  if (!fill || !status) return\r\n\r\n  const compostTile = state.map?.tiles?.compost\r\n  const contamination = compostTile?.contamination ?? 0\r\n\r\n  fill.style.width = `${contamination * 100}%`\r\n\r\n  if (compostTile?.blighted) {\r\n    status.textContent = `BLIGHTED (${compostTile.blight_ticks_remaining}t remaining)`\r\n    status.style.color = '#a55'\r\n  } else if (contamination > 0) {\r\n    status.textContent = `${(contamination * 100).toFixed(1)}% blight chance`\r\n    status.style.color = '#755'\r\n  } else {\r\n    status.textContent = 'clean'\r\n    status.style.color = '#555'\r\n  }\r\n}\r\n\r\nexport function renderSystems(state: GameState): void {\r\n  const el = document.getElementById('systems')\r\n  if (!el) return\r\n\r\n  const systems = state.systems ?? {}\r\n  if (Object.keys(systems).length === 0) {\r\n    el.innerHTML = '<div class=\"empty\">no systems</div>'\r\n    return\r\n  }\r\n\r\n  el.innerHTML = Object.entries(systems)\r\n    .map(([id, system]) => {\r\n      let output = ''\r\n      if (system.generates && Object.keys(system.generates).length > 0) {\r\n        output = Object.entries(system.generates)\r\n          .map(([r, v]) => `+${v}/tick ${r}`)\r\n          .join(', ')\r\n      }\r\n      return `\r\n        <div class=\"system\">\r\n          <div class=\"system-name\">${system.name ?? id}</div>\r\n          <div class=\"system-output\">${output || 'idle'}</div>\r\n        </div>\r\n      `\r\n    })\r\n    .join('')\r\n}\r\n\r\nexport function renderCorpses(state: GameState): void {\r\n  const el = document.getElementById('corpses')\r\n  if (!el) return\r\n\r\n  const graveyard = state.graveyard ?? { corpses: [], total_processed: 0 }\r\n  const corpses = graveyard.corpses ?? []\r\n  const processed = graveyard.total_processed ?? 0\r\n\r\n  if (corpses.length === 0 && processed === 0) {\r\n    el.innerHTML = '<div class=\"empty\">none</div>'\r\n    return\r\n  }\r\n\r\n  el.innerHTML = `\r\n    <div class=\"stat-row\">\r\n      <span class=\"stat-label\">awaiting</span>\r\n      <span class=\"stat-value\">${corpses.length}</span>\r\n    </div>\r\n    <div class=\"stat-row\">\r\n      <span class=\"stat-label\">processed</span>\r\n      <span class=\"stat-value\">${processed}</span>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport function renderRejectedIdeas(state: GameState): void {\r\n  const el = document.getElementById('rejected')\r\n  if (!el) return\r\n\r\n  const rejected = state.meta?.rejected_ideas ?? []\r\n  if (rejected.length === 0) {\r\n    el.innerHTML = '<div class=\"empty\">empty</div>'\r\n    return\r\n  }\r\n\r\n  el.innerHTML = rejected\r\n    .map(idea => `<div class=\"graveyard-item\">${idea}</div>`)\r\n    .join('')\r\n}\r\n\r\nexport function renderEventLog(state: GameState): void {\r\n  const el = document.getElementById('event-log')\r\n  if (!el) return\r\n\r\n  const log = state.meta?.event_log ?? []\r\n  if (log.length === 0) {\r\n    el.innerHTML = '<div class=\"empty\">no events yet</div>'\r\n    return\r\n  }\r\n\r\n  // Show last 10 events, most recent first\r\n  const recent = log.slice(-10).reverse()\r\n\r\n  el.innerHTML = recent\r\n    .map(event => `\r\n      <div class=\"event-entry event-type-${event.type}\">\r\n        <div class=\"event-tick\">t${event.tick}</div>\r\n        <div class=\"event-message\">${event.message}</div>\r\n      </div>\r\n    `)\r\n    .join('')\r\n}\r\n\r\nexport function renderGoals(state: GameState): void {\r\n  const el = document.getElementById('goals')\r\n  if (!el) return\r\n\r\n  const goals = state.meta?.goals ?? {}\r\n  const resources = state.resources ?? {}\r\n\r\n  // Filter to unbuilt goals with progress tracking\r\n  const activeGoals = Object.entries(goals).filter(\r\n    ([_id, goal]) => !goal.built && goal.progress !== undefined\r\n  )\r\n\r\n  if (activeGoals.length === 0) {\r\n    el.innerHTML = '<div class=\"empty\">no active goals</div>'\r\n    return\r\n  }\r\n\r\n  el.innerHTML = activeGoals\r\n    .map(([id, goal]) => {\r\n      const costEntries = Object.entries(goal.cost)\r\n      const progressBars = costEntries.map(([resource, required]) => {\r\n        const current = resources[resource] ?? 0\r\n        const progress = goal.progress?.[resource] ?? 0\r\n        const progressPct = Math.min(100, (progress / required) * 100)\r\n        const canContribute = current > 0 && progress < required\r\n\r\n        return `\r\n          <div class=\"goal-resource\">\r\n            <div class=\"goal-resource-header\">\r\n              <span class=\"goal-resource-name\">${resource}</span>\r\n              <span class=\"goal-resource-count\">${Math.floor(progress)}/${required}</span>\r\n            </div>\r\n            <div class=\"goal-bar\">\r\n              <div class=\"goal-bar-fill ${canContribute ? 'can-contribute' : ''}\" style=\"width: ${progressPct}%\"></div>\r\n            </div>\r\n          </div>\r\n        `\r\n      }).join('')\r\n\r\n      const totalProgress = costEntries.reduce((sum, [resource, required]) => {\r\n        const progress = goal.progress?.[resource] ?? 0\r\n        return sum + (progress / required)\r\n      }, 0) / costEntries.length * 100\r\n\r\n      return `\r\n        <div class=\"goal-card\">\r\n          <div class=\"goal-header\">\r\n            <span class=\"goal-name\">${goal.name}</span>\r\n            <span class=\"goal-pct\">${totalProgress.toFixed(0)}%</span>\r\n          </div>\r\n          <div class=\"goal-desc\">${goal.description}</div>\r\n          <div class=\"goal-resources\">\r\n            ${progressBars}\r\n          </div>\r\n        </div>\r\n      `\r\n    })\r\n    .join('')\r\n}\r\n\r\nexport function renderAll(state: GameState): void {\r\n  renderTick(state)\r\n  renderResources(state)\r\n  renderEntities(state)\r\n  renderBoredom(state)\r\n  renderSanity(state)\r\n  renderContamination(state)\r\n  renderSystems(state)\r\n  renderCorpses(state)\r\n  renderRejectedIdeas(state)\r\n  renderEventLog(state)\r\n  renderGoals(state)\r\n}\r\n","import type { Entity } from '../types/state.ts'\r\n\r\ninterface EntityDot {\r\n  x: number\r\n  y: number\r\n  entity: Entity\r\n}\r\n\r\nlet tooltipEl: HTMLDivElement | null = null\r\n\r\nexport function initTooltip(): void {\r\n  tooltipEl = document.createElement('div')\r\n  tooltipEl.className = 'entity-tooltip'\r\n  tooltipEl.style.display = 'none'\r\n  document.body.appendChild(tooltipEl)\r\n}\r\n\r\nexport function handleTooltipHover(\r\n  e: MouseEvent,\r\n  mapContainer: HTMLElement,\r\n  entityDots: Map<string, EntityDot>\r\n): void {\r\n  if (!tooltipEl) return\r\n\r\n  const rect = mapContainer.getBoundingClientRect()\r\n  const mouseX = e.clientX - rect.left\r\n  const mouseY = e.clientY - rect.top\r\n\r\n  // Find nearest entity within range\r\n  let nearestEntity: Entity | null = null\r\n  let nearestDist = 20 // Detection radius in pixels\r\n\r\n  for (const [_id, dot] of entityDots) {\r\n    const dx = dot.x - mouseX\r\n    const dy = dot.y - mouseY\r\n    const dist = Math.sqrt(dx * dx + dy * dy)\r\n    if (dist < nearestDist) {\r\n      nearestDist = dist\r\n      nearestEntity = dot.entity\r\n    }\r\n  }\r\n\r\n  if (nearestEntity) {\r\n    showTooltip(nearestEntity, e.clientX, e.clientY)\r\n  } else {\r\n    hideTooltip()\r\n  }\r\n}\r\n\r\nfunction showTooltip(entity: Entity, x: number, y: number): void {\r\n  if (!tooltipEl) return\r\n\r\n  const agePercent = ((entity.age / entity.max_age) * 100).toFixed(1)\r\n  const hungerPercent = entity.hunger.toFixed(1)\r\n\r\n  let content = `<div class=\"tooltip-header\">`\r\n  if (entity.type === 'visitor') {\r\n    content += `<span class=\"tooltip-type visitor\">${entity.name || entity.subtype || 'visitor'}</span>`\r\n  } else {\r\n    content += `<span class=\"tooltip-type\">${entity.role || 'ant'}</span>`\r\n    if (entity.adorned) {\r\n      content += `<span class=\"tooltip-adorned\">â˜…</span>`\r\n    }\r\n  }\r\n  content += `</div>`\r\n\r\n  content += `<div class=\"tooltip-stats\">`\r\n  content += `<div class=\"tooltip-row\"><span>age:</span><span>${agePercent}%</span></div>`\r\n  content += `<div class=\"tooltip-row\"><span>hunger:</span><span>${hungerPercent}</span></div>`\r\n  content += `<div class=\"tooltip-row\"><span>tile:</span><span>${entity.tile}</span></div>`\r\n\r\n  if (entity.type === 'visitor' && entity.description) {\r\n    content += `<div class=\"tooltip-desc\">${entity.description}</div>`\r\n  }\r\n\r\n  if (entity.processing_corpse) {\r\n    content += `<div class=\"tooltip-activity\">processing corpse...</div>`\r\n  }\r\n\r\n  content += `</div>`\r\n\r\n  tooltipEl.innerHTML = content\r\n  tooltipEl.style.display = 'block'\r\n  tooltipEl.style.left = `${x + 15}px`\r\n  tooltipEl.style.top = `${y + 15}px`\r\n}\r\n\r\nfunction hideTooltip(): void {\r\n  if (tooltipEl) {\r\n    tooltipEl.style.display = 'none'\r\n  }\r\n}\r\n","import { SSEClient, fetchInitialState } from './sse/client.ts'\r\nimport { setupCanvas, clearCanvas } from './renderer/canvas.ts'\r\nimport { renderTiles, drawConnections } from './renderer/tiles.ts'\r\nimport { updateEntityDots, drawEntityDots, getEntityDots } from './renderer/entities.ts'\r\nimport { updateParticles, spawnResourceParticles, drawParticles } from './renderer/particles.ts'\r\nimport { updateSpirits, drawSpirits } from './renderer/spirits.ts'\r\nimport { renderAll } from './ui/panels.ts'\r\nimport { initTooltip, handleTooltipHover } from './ui/tooltip.ts'\r\nimport type { GameState } from './types/state.ts'\r\n\r\nlet currentState: GameState | null = null\r\n\r\nfunction main() {\r\n  const mapContainer = document.getElementById('map')\r\n  if (!mapContainer) {\r\n    console.error('Map container not found')\r\n    return\r\n  }\r\n\r\n  const container = mapContainer // Capture for closure\r\n  const canvasContext = setupCanvas(container)\r\n  const client = new SSEClient('/events')\r\n\r\n  // Initialize tooltip system\r\n  initTooltip()\r\n  container.addEventListener('mousemove', (e) => {\r\n    const entityDots = getEntityDots()\r\n    handleTooltipHover(e, container, entityDots)\r\n  })\r\n\r\n  // Handle state updates\r\n  function handleState(state: GameState) {\r\n    currentState = state\r\n    renderAll(state)\r\n    renderTiles(container, state)\r\n  }\r\n\r\n  // Animation loop\r\n  function animate() {\r\n    if (currentState) {\r\n      clearCanvas(canvasContext)\r\n\r\n      // Draw connections behind everything\r\n      drawConnections(canvasContext.ctx, currentState)\r\n\r\n      // Update and draw spirits (corpse ghosts)\r\n      updateSpirits(currentState)\r\n      drawSpirits(canvasContext.ctx)\r\n\r\n      // Update and draw entities\r\n      updateEntityDots(currentState)\r\n      drawEntityDots(canvasContext.ctx)\r\n\r\n      // Spawn and draw particles\r\n      spawnResourceParticles(currentState)\r\n      updateParticles()\r\n      drawParticles(canvasContext.ctx)\r\n    }\r\n\r\n    requestAnimationFrame(animate)\r\n  }\r\n\r\n  // Start\r\n  client.onState(handleState)\r\n  client.connect()\r\n  animate()\r\n\r\n  // Load initial state\r\n  fetchInitialState().then(state => {\r\n    if (state) handleState(state)\r\n  })\r\n}\r\n\r\n// Wait for DOM\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', main)\r\n} else {\r\n  main()\r\n}\r\n"],"names":["SSEClient","url","__publicField","event","state","handler","e","fetchInitialState","setupCanvas","container","canvas","ctx","resize","clearCanvas","context","TILE_SIZE","TILE_GAP","OFFSET_X","OFFSET_Y","getTilePosition","tile","x","y","getTileCenter","tileId","tiles","pos","renderTiles","existing","tilesContainer","_a","systems","entities","id","div","system","_b","antsHere","visitorsHere","entityInfo","drawConnections","connections","from","to","fromCenter","toCenter","entityDots","getEntityDots","updateEntityDots","entity","tileCenter","dot","livingIds","drawEntityDots","_id","size","color","particles","spawnParticle","updateParticles","i","p","spawnResourceParticles","_c","drawParticles","spirits","updateSpirits","corpses","corpseIds","c","corpse","center","spirit","drawSpirits","gradient","renderTick","el","renderResources","resources","name","value","renderEntities","byRole","visitors","role","html","count","v","renderBoredom","fill","boredom","pct","renderSanity","sanity","renderContamination","status","compostTile","contamination","renderSystems","output","r","renderCorpses","graveyard","processed","renderRejectedIdeas","rejected","idea","renderEventLog","log","recent","renderGoals","goals","activeGoals","goal","costEntries","progressBars","resource","required","current","progress","progressPct","canContribute","totalProgress","sum","renderAll","tooltipEl","initTooltip","handleTooltipHover","mapContainer","rect","mouseX","mouseY","nearestEntity","nearestDist","dx","dy","dist","showTooltip","hideTooltip","agePercent","hungerPercent","content","currentState","main","canvasContext","client","handleState","animate"],"mappings":"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"}